<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Credit Risk Predictor</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="logo.png" alt="Logo" class="logo">
            <h1>Credit Risk Predictor</h1>
            <p>Empowering financial decisions with intelligent risk assessment.</p>
        </div>
        <form id="loan-form">
            <div class="form-group">
                <label for="credit_score">Credit Score</label>
                <input type="number" id="credit_score" required placeholder="e.g., 750">
            </div>
            <div class="form-group">
                <label for="annual_income">Annual Income (INR)</label>
                <input type="number" id="annual_income" required placeholder="e.g., 850000">
            </div>
            <div class="form-group">
                <label for="loan_amount">Loan Amount (INR)</label>
                <input type="number" id="loan_amount" required placeholder="e.g., 500000">
            </div>
            <div class="form-group">
                <label for="loan_term_years">Loan Term (years)</label>
                <input type="number" id="loan_term_years" required placeholder="e.g., 5">
            </div>
            <button type="submit">
                Assess Risk 
                <span class="icon">➡️</span>
            </button>
        </form>
        <div id="prediction_result" class="result"></div>
    </div>
    
    <script>
        // TODO: Replace with your actual Render API URL
        const BACKEND_URL = "https://your-render-app-name.onrender.com";

        document.getElementById('loan-form').addEventListener('submit', async function(event) {
            event.preventDefault();
            const form = document.getElementById('loan-form');
            const button = form.querySelector('button[type="submit"]');

            const credit_score = document.getElementById('credit_score').value;
            const annual_income = document.getElementById('annual_income').value;
            const loan_amount = document.getElementById('loan_amount').value;
            const loan_term_years = document.getElementById('loan_term_years').value;

            const inputData = {
                'credit_score': parseInt(credit_score),
                'annual_income': parseFloat(annual_income),
                'loan_amount': parseFloat(loan_amount),
                'loan_term_years': parseInt(loan_term_years)
            };

            const resultDiv = document.getElementById('prediction_result');
            resultDiv.innerHTML = '<div class="spinner"></div><p>Assessing risk...</p>';
            resultDiv.classList.add('loading');
            button.disabled = true;

            try {
                const response = await fetch(`${BACKEND_URL}/predict`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(inputData)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                const predictionText = result.prediction.toLowerCase();
                
                let resultMessage = '';
                let resultClass = '';

                if (predictionText.includes('low')) {
                    resultMessage = `✅ Low Risk: The applicant is a good candidate for a loan.`;
                    resultClass = 'low-risk';
                } else if (predictionText.includes('high')) {
                    resultMessage = `⚠️ High Risk: The applicant poses a significant credit risk.`;
                    resultClass = 'high-risk';
                } else {
                    resultMessage = `Prediction: ${result.prediction}`;
                    resultClass = '';
                }

                resultDiv.innerHTML = `<p>${resultMessage}</p>`;
                resultDiv.className = `result ${resultClass}`;

            } catch (error) {
                console.error('Error:', error);
                resultDiv.innerHTML = '<p class="error">❌ Error assessing risk. Please try again.</p>';
                resultDiv.className = 'result error-state';
            } finally {
                resultDiv.classList.remove('loading');
                button.disabled = false;
            }
        });
    </script>
</body>
</html>